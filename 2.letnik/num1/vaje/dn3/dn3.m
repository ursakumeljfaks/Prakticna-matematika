format long

%1. naloga
yP = [12.72;13.33;13.44;12.16;10.84;9.120;6.440;4.920;4.500;6.670;9.580;11.40;12.49;13.15;13.35;12.79;11.44;9.600;6.660;5.140;4.460;7.700;9.190;11.19;12.54;13.51;13.41;12.76;11.37;9.890;7.140;5.350;5.370;7.69;9.69;11.66;12.85;13.54;13.71;12.95;11.35;9.2;6.17;4.65;4.52;6.98;9.490;11.41;12.8;13.46;13.47;12.84;11.6;9.62;6.85;5.1;5.08;7.17;9.64;11.43;12.72;13.3;13.28;12.32;10.76;8.86;6.05;4.61;4.38;5.91;8.95;11.02;12.07;12.9;12.83;12.23;11.22;9.78;7.36;5.65;5.58;7.49;8.7;10.96;12.3;13.36;13.24;12.48;11.17;9.14;6.41;5.03;4.84;6.39;9;11.19;12.73;13.7;13.5;12.77;11.35;9.11;6.38;4.61;4.24;6.65;8.82;10.85;12.54;13.38;13.47;13.08;11.61;9.18;6.49;4.67;4.22;6.77;9.21;10.93;12.22;13.02;13.1;12.51;11.18;8.99;6.31;4.71;4.31;6.64;8.81;10.9;12.27;13.14;13.57;12.99;11.32;9.01;6.22;4.87;4.55;6.59;9.02;10.49;12.19;13.36;13.36;12.35;11.11;9.13;6.34;4.23;3.98;6.2;8.69;10.58;12.21;13.16;13.36;12.38;10.82;9.05;6.06;4.44;4.01;5.93;8.5;10.74;12.19;12.87;12.93;12.08;10.86;9.18;6.43;4.57;4.35;6.35;8.9;10.91;11.84;12.27;12.67;12.16;10.83;8.74;5.81;4.14;4.03;5.71;8.73;10.51;11.57;12.28;12.44;11.97;10.39;8.34;5.71;4.24;3.97;5.74;8.07;10.1;11.79;12.52;12.49;11.75;10.71;8.15;5.03;3.11;2.78;4.21;8;10.11;11.89;12.81;13.17;12.42;10.83;8.47;5.7;3.43;2.93;5.4;8.7;10.6;11.91;12.82;13.04;12.54;11.08;8.86;5.71;3.79;3.42;4.85;7.98;10.17;11.59;12.52;13.11;12.43;10.48;7.98;5.21;3.54;3.02;5.13;8.06;10.02;11.38;12.32;12.4]; 
xP = (1:255)'; 

c = [mean(yP);5;pi/6;5;pi/6];
F_iskani = @(c,x) c(1) + c(2) * sin(c(3) * x) + c(4) * cos(c(5) * x);

F = @(c) F_iskani(c,xP) - yP;
JF = @(c) [ones(length(xP), 1), sin(c(3) .* xP), c(2) .* xP .* cos(c(3) .* xP), cos(c(5) .* xP), -c(4) .* xP .* sin(c(5) .* xP)];
%1.1 
norm(JF(c),1);
%1.2
rez = newton_metoda(F,JF,c,1,1e-5);
%1.3
v = newton_metoda(F,JF,c,1000,1e-16);
produkt = prod(v);
geo = nthroot(produkt,length(v));
%1.4
razlika = yP - F_iskani(v,xP);
max_odstopanje = max(abs(razlika));

%2. naloga
a = 1.100;
g = @(x) (8.*(a^3))./(x.^2 + 4.*a^2);
x2 = linspace(-2,4,9);
y2 = g(x2);
%2.1 
p_koef = polyfit(x2,y2,8); %odgovor je ta prva
dif = deljeneDif(x2,y2);
zadnja = dif(9,:);
%2.2
x_risi = linspace(-2,4,100);
y_risi = g(x_risi);
plot(x2,y2,"o")
hold on
plot(x_risi,y_risi,"b")
plot(x_risi,polyval(p_koef,x_risi),"r") 
%polyval evaluera polinom s koeficienti p_koef (3x^2+x+2 -> [3,1,2] v
%tockah x_risi
odstopanje = max(abs(y_risi- polyval(p_koef,x_risi)));
%2.3
x_tocke = [-2, -1.5, -1, 0, 1, 2, 3, 3.5, 4];
y_tocke = g(x_tocke);
polinom = polyfit(x_tocke,y_tocke,8);
p2 = @(x) polyval(polinom,x);
norma1 = sqrt(integral(@(x)(g(x)-p2(x)).^2,-2,4));
%2.4
Z = linspace(-2,4,5);
zm = Z(end);
z0 = Z(1);
vsota = 0;
for i = 1:length(Z)
    zi = Z(i);
    vsota = vsota + (g(zi)-p2(zi)).^2;
end
skalar = vsota*(zm - z0)/length(Z);
norma2 = sqrt(skalar);
%2.5
w = @(x) prod(x-x_tocke);
[xmin, ymin] = fminbnd(@(x) -1*w(x), -2,-1.5);
[xmax, ymax] = fminbnd(@(x) w(x),-2,-1.5);
maksimum = max(abs(ymin), abs(ymax));
napaka = maksimum*1500/factorial(9);

%3. naloga
d = 118/101;
A = [5 d 4 3;
     d 3 7 1;
     4 7 1 0;
     3 1 0 2];
%3.1
[lambda, z] = potencnaMetoda(A, [1; 0; 0; 0], 100, 1e-10); %uporabis korak = 6
%3.2
B = A - lambda*(z.*z');
[lambda2, z2] = potencnaMetoda(B,[1; 0; 0; 0], 11, 1e-10);
